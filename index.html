<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="Sistema de controle de abastecimento para locomotiva U20-3830">
  <meta name="theme-color" content="#06b6d4">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="manifest" href="manifest.json">
  <title>Combust√≠vel U20-3830</title>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      background: linear-gradient(135deg, #1f2937 0%, #111827 50%, #1f2937 100%);
      color: white;
      min-height: 100vh;
      padding: 10px;
      overflow-x: hidden;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 20px;
      padding: 10px;
    }

    .header-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-bottom: 8px;
      flex-wrap: wrap;
    }

    .header h1 {
      font-size: 1.5rem;
      background: linear-gradient(to right, #06b6d4, #3b82f6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header p {
      color: #9ca3af;
      font-size: 0.875rem;
    }

    .card {
      background: #1f2937;
      border: 1px solid #374151;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 20px 40px -12px rgba(0, 0, 0, 0.5);
    }

    .gauge-container {
      position: relative;
      width: 100%;
      max-width: 350px;
      height: 240px;
      margin: 0 auto 30px;
    }

    .digital-display {
      position: absolute;
      bottom: 5px;
      left: 50%;
      transform: translateX(-50%);
      background: #000;
      border: 2px solid rgba(6, 182, 212, 0.5);
      border-radius: 8px;
      padding: 12px 25px;
      min-width: 150px;
      text-align: center;
    }

    .digital-liters {
      font-size: 1.75rem;
      font-weight: bold;
      color: #06b6d4;
      font-family: monospace;
      line-height: 1;
    }

    .digital-percent {
      font-size: 0.7rem;
      color: #9ca3af;
      margin-top: 4px;
    }

    .controls {
      display: grid;
      gap: 15px;
    }

    .input-row {
      display: grid;
      grid-template-columns: 1fr;
      gap: 15px;
    }

    .input-group {
      display: flex;
      flex-direction: column;
    }

    .input-group label {
      font-size: 0.8rem;
      color: #9ca3af;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .input-split {
      display: grid;
      grid-template-columns: 1.2fr 1fr;
      gap: 8px;
    }

    input[type="date"],
    input[type="time"] {
      width: 100%;
      padding: 12px;
      background: #111827;
      border: 1px solid #374151;
      border-radius: 8px;
      color: white;
      font-size: 1rem;
      touch-action: manipulation;
    }

    input[type="date"]:focus,
    input[type="time"]:focus {
      outline: none;
      border-color: #06b6d4;
      box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.2);
    }

    .status-display {
      background: #111827;
      border: 1px solid #374151;
      border-radius: 10px;
      padding: 15px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      text-align: center;
    }

    .status-item {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .status-label {
      color: #9ca3af;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .status-value {
      color: white;
      font-size: 1.25rem;
      font-weight: 700;
    }

    .button-row {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    button {
      padding: 16px;
      border: none;
      border-radius: 10px;
      font-weight: bold;
      font-size: 1rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.2s;
      touch-action: manipulation;
      -webkit-user-select: none;
      user-select: none;
    }

    button:active {
      transform: scale(0.98);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-save {
      background: linear-gradient(to right, #10b981, #059669);
      color: white;
      box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
    }

    .btn-refuel {
      background: linear-gradient(to right, #06b6d4, #3b82f6);
      color: white;
      box-shadow: 0 8px 20px rgba(6, 182, 212, 0.3);
    }

    .btn-whatsapp {
      background: linear-gradient(to right, #059669, #047857);
      color: white;
      box-shadow: 0 8px 20px rgba(5, 150, 105, 0.3);
    }

    .history {
      margin-top: 25px;
      background: #111827;
      border: 1px solid #374151;
      border-radius: 10px;
      padding: 15px;
    }

    .history h3 {
      margin-bottom: 15px;
      font-size: 1rem;
    }

    .history-list {
      max-height: 400px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .history-item {
      background: #1f2937;
      border: 1px solid #374151;
      border-radius: 8px;
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      transition: border-color 0.3s;
    }

    .history-item:active {
      border-color: #06b6d4;
    }

    .history-data {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      font-size: 0.8rem;
    }

    .history-field label {
      color: #9ca3af;
      font-size: 0.65rem;
      display: block;
      margin-bottom: 3px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .history-field .value {
      color: white;
      font-family: monospace;
      font-size: 0.85rem;
    }

    .history-field .highlight-cyan {
      color: #06b6d4;
      font-weight: 600;
    }

    .history-field .highlight-red {
      color: #ef4444;
      font-weight: 600;
    }

    .btn-delete {
      background: rgba(239, 68, 68, 0.1);
      color: #ef4444;
      padding: 10px;
      border-radius: 8px;
      width: 100%;
      font-size: 0.875rem;
    }

    .btn-delete:active {
      background: rgba(239, 68, 68, 0.2);
    }

    .history-summary {
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #374151;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      text-align: center;
    }

    .summary-item label {
      color: #9ca3af;
      font-size: 0.65rem;
      display: block;
      margin-bottom: 5px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .summary-item .value {
      color: white;
      font-size: 1.25rem;
      font-weight: 700;
    }

    .summary-item .value.red {
      color: #ef4444;
    }

    .warning {
      margin-top: 20px;
      background: rgba(239, 68, 68, 0.2);
      border: 1px solid rgba(239, 68, 68, 0.5);
      border-radius: 10px;
      padding: 15px;
      text-align: center;
      animation: pulse 2s infinite;
    }

    .warning p {
      color: #ef4444;
      font-weight: 600;
      font-size: 0.95rem;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .hidden {
      display: none;
    }

    .icon {
      width: 32px;
      height: 32px;
      fill: #06b6d4;
    }

    /* Scrollbar styling */
    .history-list::-webkit-scrollbar {
      width: 6px;
    }

    .history-list::-webkit-scrollbar-track {
      background: #1f2937;
      border-radius: 3px;
    }

    .history-list::-webkit-scrollbar-thumb {
      background: #374151;
      border-radius: 3px;
    }

    .history-list::-webkit-scrollbar-thumb:hover {
      background: #4b5563;
    }

    @media (min-width: 640px) {
      body {
        padding: 20px;
      }

      .header {
        margin-bottom: 30px;
      }

      .header h1 {
        font-size: 2rem;
      }

      .card {
        padding: 30px;
      }

      .gauge-container {
        max-width: 400px;
        height: 280px;
      }

      .status-display {
        grid-template-columns: repeat(3, 1fr);
        padding: 20px;
      }

      .button-row {
        grid-template-columns: repeat(3, 1fr);
      }

      .input-row {
        grid-template-columns: 1fr 1fr;
      }

      .history-data {
        grid-template-columns: repeat(4, 1fr);
      }

      .btn-delete {
        width: auto;
        min-width: 80px;
      }

      .history-item {
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="header-content">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="2" y="6" width="20" height="12" rx="2"/>
          <path d="M2 10h20M2 14h20"/>
        </svg>
        <h1>Locomotiva U20 - 3830</h1>
      </div>
      <p>Sistema de Controle de Combust√≠vel</p>
    </div>

    <div class="card">
      <!-- Medidor de Combust√≠vel -->
      <div class="gauge-container">
        <svg id="fuelGauge" viewBox="0 0 400 280" style="width: 100%; height: 100%;">
          <defs>
            <linearGradient id="gaugeGradient" x1="0%" y1="0%" x2="0%" y2="100%">
              <stop offset="0%" style="stop-color:#1f2937;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#111827;stop-opacity:1" />
            </linearGradient>
            <linearGradient id="redZone" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" style="stop-color:#ef4444;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#dc2626;stop-opacity:1" />
            </linearGradient>
            <linearGradient id="greenZone" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
            </linearGradient>
            <linearGradient id="needleGradient" x1="0%" y1="0%" x2="0%" y2="100%">
              <stop offset="0%" style="stop-color:#fca5a5;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#ef4444;stop-opacity:1" />
            </linearGradient>
          </defs>

          <circle cx="200" cy="200" r="160" fill="url(#gaugeGradient)" stroke="#374151" stroke-width="3"/>
          <circle cx="200" cy="200" r="140" fill="#111827" stroke="#1f2937" stroke-width="2"/>

          <!-- Red Zone Arc -->
          <path d="M 60 130 A 150 150 0 0 1 100 60" fill="none" stroke="url(#redZone)" stroke-width="20" stroke-linecap="round" opacity="0.6"/>
          
          <!-- Green Zone Arc -->
          <path d="M 300 60 A 150 150 0 0 1 340 130" fill="none" stroke="url(#greenZone)" stroke-width="20" stroke-linecap="round" opacity="0.6"/>

          <!-- Tick Marks -->
          <g id="tickMarks"></g>

          <!-- Labels -->
          <text x="70" y="145" fill="#ef4444" font-size="32" font-weight="bold" font-family="Arial">E</text>
          <text x="310" y="145" fill="#10b981" font-size="32" font-weight="bold" font-family="Arial">F</text>
          <text x="200" y="170" fill="#9ca3af" font-size="16" font-weight="600" font-family="Arial" text-anchor="middle">FUEL</text>

          <!-- Center Pin -->
          <circle cx="200" cy="200" r="12" fill="#374151" stroke="#1f2937" stroke-width="2"/>

          <!-- Needle -->
          <g id="needle" style="transform-origin: 200px 200px; transition: transform 0.8s cubic-bezier(0.4, 0.0, 0.2, 1);">
            <polygon points="200,200 195,205 200,90 205,205" fill="#ef4444" stroke="#dc2626" stroke-width="1"/>
            <polygon points="200,200 195,205 200,90 205,205" fill="url(#needleGradient)"/>
          </g>

          <!-- Center Cap -->
          <circle cx="200" cy="200" r="8" fill="#ef4444"/>
          <circle cx="200" cy="200" r="4" fill="#1f2937"/>
        </svg>

        <div class="digital-display">
          <div class="digital-liters" id="displayLiters">6000L</div>
          <div class="digital-percent" id="displayPercent">100.0%</div>
        </div>
      </div>

      <!-- Controles -->
      <div class="controls">
        <div class="input-row">
          <div class="input-group">
            <label>üìÖ Data e Hor√°rio de In√≠cio</label>
            <div class="input-split">
              <input type="date" id="startDate">
              <input type="time" id="startTime">
            </div>
          </div>
          <div class="input-group">
            <label>üìÖ Data e Hor√°rio Final</label>
            <div class="input-split">
              <input type="date" id="endDate">
              <input type="time" id="endTime">
            </div>
          </div>
        </div>

        <!-- Status Display -->
        <div class="status-display">
          <div class="status-item">
            <span class="status-label">Tempo Opera√ß√£o</span>
            <span class="status-value" id="hoursRunning">0.00h</span>
          </div>
          <div class="status-item">
            <span class="status-label">Consumo</span>
            <span class="status-value">25L/h</span>
          </div>
          <div class="status-item">
            <span class="status-label">Total Consumido</span>
            <span class="status-value" id="totalConsumed">0L</span>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="button-row">
          <button class="btn-save" id="btnSave" disabled>
            <span>üíæ</span> SALVAR
          </button>
          <button class="btn-refuel" id="btnRefuel">
            <span>‚õΩ</span> ABASTECER
          </button>
          <button class="btn-whatsapp" id="btnWhatsapp">
            <span>üì±</span> WHATSAPP
          </button>
        </div>
      </div>

      <!-- Hist√≥rico -->
      <div class="history hidden" id="historySection">
        <h3>üìã Hist√≥rico de Registros</h3>
        <div class="history-list" id="historyList"></div>
        <div class="history-summary">
          <div class="summary-item">
            <label>Tempo Total</label>
            <div class="value" id="summaryHours">0.00h</div>
          </div>
          <div class="summary-item">
            <label>Combust√≠vel Total</label>
            <div class="value red" id="summaryFuel">0L</div>
          </div>
        </div>
      </div>

      <!-- Warning -->
      <div class="warning hidden" id="warningSection">
        <p>‚ö†Ô∏è N√çVEL CR√çTICO - ABASTECER URGENTE!</p>
      </div>
    </div>
  </div>

  <script>
    // Estado da aplica√ß√£o
    const state = {
      fuelLevel: 100,
      maxCapacity: 6000,
      fuelLiters: 6000,
      avgConsumption: 25,
      hoursRunning: 0,
      records: []
    };

    // Carregar dados do localStorage
    function loadData() {
      const saved = localStorage.getItem('fuelData');
      if (saved) {
        try {
          const data = JSON.parse(saved);
          state.fuelLevel = data.fuelLevel || 100;
          state.fuelLiters = data.fuelLiters || 6000;
          state.records = data.records || [];
        } catch (e) {
          console.error('Erro ao carregar dados:', e);
        }
      }
    }

    // Salvar dados no localStorage
    function saveData() {
      try {
        localStorage.setItem('fuelData', JSON.stringify({
          fuelLevel: state.fuelLevel,
          fuelLiters: state.fuelLiters,
          records: state.records
        }));
      } catch (e) {
        console.error('Erro ao salvar dados:', e);
      }
    }

    // Elementos DOM
    const elements = {
      startDate: document.getElementById('startDate'),
      startTime: document.getElementById('startTime'),
      endDate: document.getElementById('endDate'),
      endTime: document.getElementById('endTime'),
      hoursRunning: document.getElementById('hoursRunning'),
      totalConsumed: document.getElementById('totalConsumed'),
      displayLiters: document.getElementById('displayLiters'),
      displayPercent: document.getElementById('displayPercent'),
      needle: document.getElementById('needle'),
      btnSave: document.getElementById('btnSave'),
      btnRefuel: document.getElementById('btnRefuel'),
      btnWhatsapp: document.getElementById('btnWhatsapp'),
      historySection: document.getElementById('historySection'),
      historyList: document.getElementById('historyList'),
      summaryHours: document.getElementById('summaryHours'),
      summaryFuel: document.getElementById('summaryFuel'),
      warningSection: document.getElementById('warningSection')
    };

    // Criar marca√ß√µes do medidor
    function createTickMarks() {
      const tickMarks = document.getElementById('tickMarks');
      for (let i = 0; i < 9; i++) {
        const angle = -135 + (i * 33.75);
        const radian = (angle * Math.PI) / 180;
        const x1 = 200 + Math.cos(radian) * 120;
        const y1 = 200 + Math.sin(radian) * 120;
        const x2 = 200 + Math.cos(radian) * (i % 2 === 0 ? 105 : 110);
        const y2 = 200 + Math.sin(radian) * (i % 2 === 0 ? 105 : 110);
        
        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        line.setAttribute('x1', x1);
        line.setAttribute('y1', y1);
        line.setAttribute('x2', x2);
        line.setAttribute('y2', y2);
        line.setAttribute('stroke', i <= 2 ? '#ef4444' : i >= 6 ? '#10b981' : '#6b7280');
        line.setAttribute('stroke-width', i % 2 === 0 ? '3' : '2');
        line.setAttribute('stroke-linecap', 'round');
        tickMarks.appendChild(line);
      }
    }

    // Atualizar display
    function updateDisplay() {
      const needleAngle = -135 + (state.fuelLevel * 2.7);
      elements.needle.style.transform = `rotate(${needleAngle}deg)`;
      elements.displayLiters.textContent = `${Math.round(state.fuelLiters)}L`;
      elements.displayPercent.textContent = `${state.fuelLevel.toFixed(1)}%`;
      elements.hoursRunning.textContent = `${state.hoursRunning.toFixed(2)}h`;
      elements.totalConsumed.textContent = `${Math.round(state.hoursRunning * state.avgConsumption)}L`;
      
      // Mostrar/ocultar warning
      if (state.fuelLevel < 25) {
        elements.warningSection.classList.remove('hidden');
      } else {
        elements.warningSection.classList.add('hidden');
      }
    }

    // Calcular consumo
    function calculateConsumption() {
      const startDate = elements.startDate.value;
      const startTime = elements.startTime.value;
      const endDate = elements.endDate.value;
      const endTime = elements.endTime.value;

      if (startDate && startTime && endDate && endTime) {
        const start = new Date(`${startDate}T${startTime}`);
        const end = new Date(`${endDate}T${endTime}`);
        
        const diffMs = end.getTime() - start.getTime();
        const diffHours = Math.max(0, diffMs / (1000 * 60 * 60));
        
        state.hoursRunning = diffHours;
        
        // Calcular consumo total incluindo registros anteriores
        const previousConsumption = state.records.reduce((acc, r) => acc + r.fuelConsumed, 0);
        const currentConsumption = diffHours * state.avgConsumption;
        const totalConsumed = previousConsumption + currentConsumption;
        
        const remaining = Math.max(0, state.maxCapacity - totalConsumed);
        state.fuelLiters = remaining;
        state.fuelLevel = (remaining / state.maxCapacity) * 100;
        
        elements.btnSave.disabled = false;
      } else {
        elements.btnSave.disabled = true;
      }
      
      updateDisplay();
    }

    // Salvar registro
    function saveRecord() {
      const startDate = elements.startDate.value;
      const startTime = elements.startTime.value;
      const endDate = elements.endDate.value;
      const endTime = elements.endTime.value;

      if (startDate && startTime && endDate && endTime) {
        const record = {
          id: Date.now().toString(),
          startDate,
          startTime,
          endDate,
          endTime,
          hoursRunning: state.hoursRunning,
          fuelConsumed: state.hoursRunning * state.avgConsumption,
          avgConsumption: state.avgConsumption
        };

        state.records.push(record);
        
        // Limpar campos
        elements.startDate.value = '';
        elements.startTime.value = '';
        elements.endDate.value = '';
        elements.endTime.value = '';
        state.hoursRunning = 0;
        elements.btnSave.disabled = true;

        saveData();
        renderHistory();
        updateDisplay();
      }
    }

    // Abastecer
    function refuel() {
      if (confirm('Resetar combust√≠vel para 6000L?')) {
        state.fuelLiters = state.maxCapacity;
        state.fuelLevel = 100;
        elements.startDate.value = '';
        elements.startTime.value = '';
        elements.endDate.value = '';
        elements.endTime.value = '';
        state.hoursRunning = 0;
        saveData();
        updateDisplay();
      }
    }

    // Renderizar hist√≥rico
    function renderHistory() {
      if (state.records.length === 0) {
        elements.historySection.classList.add('hidden');
        return;
      }

      elements.historySection.classList.remove('hidden');
      elements.historyList.innerHTML = '';

      state.records.forEach(record => {
        const item = document.createElement('div');
        item.className = 'history-item';
        item.innerHTML = `
          <div class="history-data">
            <div class="history-field">
              <label>In√≠cio</label>
              <div class="value">${new Date(record.startDate).toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })} ${record.startTime}</div>
            </div>
            <div class="history-field">
              <label>Fim</label>
              <div class="value">${new Date(record.endDate).toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })} ${record.endTime}</div>
            </div>
            <div class="history-field">
              <label>Tempo</label>
              <div class="value highlight-cyan">${record.hoursRunning.toFixed(2)}h</div>
            </div>
            <div class="history-field">
              <label>Consumido</label>
              <div class="value highlight-red">${Math.round(record.fuelConsumed)}L</div>
            </div>
          </div>
          <button class="btn-delete" onclick="deleteRecord('${record.id}')">
            üóëÔ∏è EXCLUIR
          </button>
        `;
        elements.historyList.appendChild(item);
      });

      // Atualizar totais
      const totalHours = state.records.reduce((acc, r) => acc + r.hoursRunning, 0);
      const totalFuel = state.records.reduce((acc, r) => acc + r.fuelConsumed, 0);
      elements.summaryHours.textContent = `${totalHours.toFixed(2)}h`;
      elements.summaryFuel.textContent = `${Math.round(totalFuel)}L`;
    }

    // Deletar registro
    function deleteRecord(id) {
      if (confirm('Excluir este registro?')) {
        state.records = state.records.filter(r => r.id !== id);
        saveData();
        renderHistory();
        calculateConsumption();
      }
    }

    // Enviar WhatsApp
    function sendToWhatsApp() {
      const totalHours = state.records.reduce((acc, r) => acc + r.hoursRunning, 0);
      const totalFuel = state.records.reduce((acc, r) => acc + r.fuelConsumed, 0);

      let message = `üöÇ *RELAT√ìRIO - LOCOMOTIVA U20-3830*\n\n`;
      message += `üìä *STATUS ATUAL:*\n`;
      message += `‚Ä¢ Capacidade: ${state.maxCapacity}L\n`;
      message += `‚Ä¢ Combust√≠vel atual: ${Math.round(state.fuelLiters)}L (${state.fuelLevel.toFixed(1)}%)\n`;
      message += `‚Ä¢ Tempo Total: ${totalHours.toFixed(2)}h\n`;
      message += `‚Ä¢ Combust√≠vel Consumido: ${Math.round(totalFuel)}L\n\n`;
      
      if (state.records.length > 0) {
        message += `üìã *HIST√ìRICO (${state.records.length} registros):*\n`;
        state.records.forEach((r, i) => {
          message += `\n${i+1}. ${new Date(r.startDate).toLocaleDateString('pt-BR')} ${r.startTime} ‚Üí ${new Date(r.endDate).toLocaleDateString('pt-BR')} ${r.endTime}\n`;
          message += `   ‚è± ${r.hoursRunning.toFixed(2)}h | ‚õΩ ${Math.round(r.fuelConsumed)}L\n`;
        });
      }

      const encodedMessage = encodeURIComponent(message);
      window.open(`https://wa.me/?text=${encodedMessage}`, '_blank');
    }

    // Event Listeners
    elements.startDate.addEventListener('change', calculateConsumption);
    elements.startTime.addEventListener('change', calculateConsumption);
    elements.endDate.addEventListener('change', calculateConsumption);
    elements.endTime.addEventListener('change', calculateConsumption);
    elements.btnSave.addEventListener('click', saveRecord);
    elements.btnRefuel.addEventListener('click', refuel);
    elements.btnWhatsapp.addEventListener('click', sendToWhatsApp);

    // Registrar Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').catch(err => {
        console.log('Service Worker registration failed:', err);
      });
    }

    // Inicializar
    loadData();
    createTickMarks();
    renderHistory();
    updateDisplay();
  </script>
</body>
</html>
